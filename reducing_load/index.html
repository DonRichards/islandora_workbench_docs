<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Reducing Workbench's impact on Drupal - Islandora Workbench</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Reducing Workbench\u0027s impact on Drupal";
        var mkdocs_page_input_path = "reducing_load.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Islandora Workbench
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installation/">Requirements and installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../configuration/">Configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../check/">Checking configuration and input data</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../preparing_data/">Preparing your data</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../fields/">Field data (Drupal and CSV)</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../ignoring_csv_rows_and_columns/">Ignoring CSV rows and columns</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../field_templates/">CSV field templates</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../paged_and_compound/">Creating paged, compound, and collection content</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../nodes_only/">Creating nodes without media</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../creating_nodes_from_files/">Creating nodes from files</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../creating_taxonomy_terms/">Creating taxonomy terms</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../aliases/">Assigning URL aliases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../alt_text/">Adding alt text to images</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../rolling_back/">Rolling back nodes and media</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../media_types/">Setting media types</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../updating_nodes/">Updating nodes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../deleting_nodes/">Deleting nodes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../adding_media/">Adding media to nodes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../deleting_media/">Deleting media</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../adding_multiple_media/">Adding multiple media</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../generating_csv_files/">Generating CSV files</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../sample_data/">Creating nodes from the sample data</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../exporting_islandora_7_content/">Exporting Islandora 7 content</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../generating_sample_content/">Generating sample Islandora content</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../hooks/">Hooks</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../fixity/">Fixity checking</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../logging/">Logging</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../cancelling/">Cancelling Workbench</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../workflows/">Workflows</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Reducing Workbench's impact on Drupal</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#basic-pause">Basic pause</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#adaptive-pause">Adaptive pause</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#logging-drupals-response-time">Logging Drupal's response time</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#caching">Caching</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../limitations/">Known limitations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../roadmap/">Roadmap (Fall 2021)</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../troubleshooting/">Troubleshooting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../changelog/">Change log</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../development_guide/">Development guide</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Islandora Workbench</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Reducing Workbench's impact on Drupal</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/mjordan/islandora_workbench_docs/edit/main/docs/reducing_load.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="reducing-workbenchs-impact-on-drupal">Reducing Workbench's impact on Drupal</h2>
<p>Workbench can put substantial stress on Drupal. In some cases, this stress can lead to instability and errors. Workbench offers two main ways to reduce this stress.</p>
<p>The first is by telling Workbench to pause between each request it makes to Drupal. There are two types of pause, 1) basic pause and 2) adaptive pause.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both types of pausing will slow down Workbench's overall execution time since they reduce speed to improve stability and reliability.</p>
</div>
<h3 id="basic-pause">Basic pause</h3>
<p>The <code>pause</code> configuration setting tells Workbench to temporarily halt execution before every 'POST', 'PUT', 'PATCH', and 'DELETE' request, thereby spreading load caused by the requests over a longer period of time. To enable <code>pause</code>, include the setting in your configuration file, indicating the number of seconds to wait between requests:</p>
<pre><code class="language-yaml">pause: 2
</code></pre>
<p>Using <code>pause</code> will help decrease load-induced errors, but it is inefficient because it causes Workbench to pause between <em>all</em> requests, even ones that are not putting stress on Drupal. A useful strategy for refining Workbench's load-reduction capabilities is to try <code>pause</code> first, and if it reduces errors, then disable <code>pause</code> and try <code>adaptive_pause</code> instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>pause</code> and <code>adaptive_pause</code> are mutually exclusive. If you include one in your configuration files, you should not include the other.</p>
</div>
<h3 id="adaptive-pause">Adaptive pause</h3>
<p>Adaptive pause only halts execution between requests if Workbench detects that Drupal is slowing down. It does this by comparing Drupal's response time for the most recent request to the average response time of the 20 previous requests. If the response time for the most recent request reaches a specific threshold, Workbench's adaptive pause will kick in and temporarily halt execution to allow Drupal to catch up.</p>
<p>The threshold that needs to be met is configured using the <code>adaptive_pause_threshold</code> setting. This setting's default value is 2, which means that the adaptive pause will kick in if the response time for the most recent request Workbench makes to Drupal is 2 times (double) the average of the last 20 requests.</p>
<p>The amount of time that Workbench will pause is determined by the value of <code>adaptive_pause</code>, which, like the value for <code>pause</code>, is a number of seconds (e.g., <code>adaptive_pause: 3</code>). You enable adaptive pausing by adding the <code>adaptive_pause</code> setting to your configuration file. Since <code>adaptive_pause_threshold</code> has a default value (2) but <code>adaptive_pause</code> does not, you should only use <code>adaptive_pause_threshold</code> if you want to override the default value. Therefore, both of the following configurations are valid. The first enables <code>adaptive_pause</code> telling it to pause for 3 seconds between requests if Drupal's response time to the last request is 2 times slower than the average of the last 20 requests (using the default value of 2 <code>adaptive_pause_threshold</code>): </p>
<pre><code class="language-yaml">adaptive_pause: 3
</code></pre>
<p>In the next example, we override <code>adaptive_pause_threshold</code>'s default by including the setting in the configuration:</p>
<pre><code class="language-yaml">adaptive_pause: 2
adaptive_pause_threshold: 2.5 
</code></pre>
<p>In this example, adaptive pausing only kicks in if the response time for the most recent request is 2.5 times the average of the response time for the last 20 requests. You can increment <code>adaptive_pause_threshold</code>'s value by .5 (e.g., 2.5, 3, 3.5, etc.) until you find a sweet spot that balances reliability with overall execution time. You can also decrease or increase the value of <code>adaptive_pause</code> incrementally by intervals of .5 to further refine the balance.</p>
<p>The number of previous requests used to determine the average response time is hard-coded to 20. There is no configuration option to change that number.</p>
<h3 id="logging-drupals-response-time">Logging Drupal's response time</h3>
<p>If a request if paused by adaptive pausing, Workbench will automatically log the response time for the next request, indicating that <code>adaptive_pause</code> has temporarily halted execution. If you want to log Drupal's response time regardless of whether <code>adaptive_pause</code> had kicked in or not, add <code>log_response_time: true</code> to your configuration file. All logging of response time includes variation from the average of the last 20 response times.</p>
<h3 id="caching">Caching</h3>
<p>The second way that Workbench reduces stress on Drupal is by caching HTTP requests. By default, this caching is enabled for requests that Workbench makes more than once and that are expected to have the same response each time, such as requests for field configurations or for checks for the existence of taxonomy terms.</p>
<p>This caching both reduces the load on Drupal and speeds up Workbench considerably. Note that you should not normally have to disable this caching, but if you do (for example, if you are asked to during troubleshooting), you can do so by including the following setting in your configuration file:</p>
<pre><code class="language-yaml">enable_http_cache: false
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../workflows/" class="btn btn-neutral float-left" title="Workflows"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../limitations/" class="btn btn-neutral float-right" title="Known limitations">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/mjordan/islandora_workbench_docs" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../workflows/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../limitations/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
