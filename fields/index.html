<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Field data (Drupal and CSV) - Islandora Workbench</title>
  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Field data (Drupal and CSV)";
    var mkdocs_page_input_path = "fields.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Islandora Workbench</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../installation/">Requirements and installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../configuration/">Configuration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../check/">Checking configuration and input data</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../preparing_data/">Preparing your data</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Field data (Drupal and CSV)</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#reserved-csv-columns">Reserved CSV columns</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#values-in-the-file-column">Values in the "file" column</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#required-columns">Required columns</a></li>
    

    <li class="toctree-l2"><a href="#columns-you-want-workbench-to-ignore">Columns you want Workbench to ignore</a></li>
    

    <li class="toctree-l2"><a href="#csv-fields-that-contain-drupal-field-data">CSV fields that contain Drupal field data</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#base-fields">Base fields</a></li>
        
            <li><a class="toctree-l3" href="#content-type-specific-fields">Content type-specific fields</a></li>
        
            <li><a class="toctree-l3" href="#single-and-multi-valued-fields">Single and multi-valued fields</a></li>
        
            <li><a class="toctree-l3" href="#drupal-field-types">Drupal field types</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ignoring_csv_rows_and_columns/">Ignoring CSV rows and columns</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../field_templates/">CSV field templates</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../paged_and_compound/">Creating paged, compound, and collection content</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nodes_only/">Creating nodes without media</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../creating_nodes_from_files/">Creating nodes from files</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../creating_taxonomy_terms/">Creating taxonomy terms</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../aliases/">Assigning URL aliases</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../alt_text/">Adding alt text to images</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../rolling_back/">Rolling back nodes and media</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../media_types/">Setting media types</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../updating_nodes/">Updating nodes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../deleting_nodes/">Deleting nodes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../adding_media/">Adding media to nodes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../deleting_media/">Deleting media</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../adding_multiple_media/">Adding multiple media</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../generating_csv_files/">Generating CSV files</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../sample_data/">Creating nodes from the sample data</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../exporting_islandora_7_content/">Exporting Islandora 7 content</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../generating_sample_content/">Generating sample Islandora content</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../hooks/">Hooks</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../fixity/">Fixity checking</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../logging/">Logging</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cancelling/">Cancelling Workbench</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../workflows/">Workflows</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../reducing_load/">Reducing Workbench's impact on Drupal</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../limitations/">Known limitations</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../roadmap/">Roadmap (Fall 2021)</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../troubleshooting/">Troubleshooting</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../changelog/">Change log</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../development_guide/">Development guide</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Islandora Workbench</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Field data (Drupal and CSV)</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/mjordan/islandora_workbench_docs/edit/main/docs/fields.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Workbench uses a CSV file to populate Islandora objects' metadata. This file contains the field values that is to be added to new or existing nodes, and some additional reserved columns specific to Workbench. Data in this CSV file can be:</p>
<ul>
<li>strings (for string or text fields) like <code>Using Islandora Workbench for Fun and Profit</code></li>
<li>integers (for <code>field_weight</code>, for example) like <code>1</code> or <code>7281</code></li>
<li>the binary values <code>1</code> or <code>0</code></li>
<li>Existing Drupal-generated entity IDs (term IDs for taxonomy terms or node IDs for collections and parents), which are integers like <code>10</code> or <code>3549</code></li>
<li>structured strings, for typed relation (e.g., <code>relators:art:30</code>), link fields (e.g., <code>https://acme.net%%Acme Products</code>), geolocation fields (e.g., <code>"49.16667,-123.93333"</code>), and athority link data (e.g., <code>viaf%%http://viaf.org/viaf/10646807%%VIAF Record</code>)</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As is standard with CSV data, values do not need to be wrapped in double quotation marks (<code>"</code>) unless they contain an instance of the delimiter character (e.g., a comma) or line breaks. Spreadsheet applications such as Google Sheets, LibreOffice Calc, and Excel will output valid CSV data.
If you are using a spreadsheet application, it will take care of wrapping the CSV values in double quotation marks when they are necessary - you do not need to wrap the field values yourself.</p>
</div>
<h2 id="reserved-csv-columns">Reserved CSV columns</h2>
<p>The following CSV columns are used for specific purposes and in some cases are required in your CSV file, depending on the task you are performing (see below for specific cases). Data in them does not directly populate Drupal content-type fields.</p>
<table>
<thead>
<tr>
<th>CSV field name</th>
<th>Task(s)</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>create</td>
<td>This CSV field is used by Workbench for internal purposes, and is not added to the metadata of your Islandora objects. Therefore, it doesn't need to have any relationship to the item described in the rest of the fields in the CSV file. You can configure this CSV field name to be something other than <code>id</code> by using the <code>id_field</code> option in your configuration file. Note that if the specified field contains multiple values, (e.g. <code>0001|spec-86389</code>), the entire field value will be used as the internal Workbench identifier.</td>
</tr>
<tr>
<td>node_id</td>
<td>update, delete, add_media, export_csv, delete_media_by_node</td>
<td>The ID of the node you are updating, deleting, or adding media to. Full URLs (including URL aliases) are also allowed in this CSV field.</td>
</tr>
<tr>
<td>file</td>
<td>create, add_media</td>
<td>See detail in "Values in the 'file' column", below.</td>
</tr>
<tr>
<td>media_use_tid</td>
<td>create, add_media</td>
<td>Tells Workbench which terms from the Islandora Media Use vocabulary to assign to media created in <code>create</code> and <code>add_media</code> tasks. This can be set for all new media in the configuration file; only include it in your CSV if you want row-level control over this value. More detail is available in the "<a href="/islandora_workbench_docs/configuration/#media-settings">Configuration</a>" docs for <code>media_use_tid</code>.</td>
</tr>
<tr>
<td>url_alias</td>
<td>create, update</td>
<td>See detail in "<a href="/islandora_workbench_docs/aliases/">Assigning URL aliases</a>".</td>
</tr>
<tr>
<td>image_alt_text</td>
<td>create</td>
<td>See detail in "<a href="/islandora_workbench_docs/alt_text/">Adding alt text to images</a>".</td>
</tr>
<tr>
<td>checksum</td>
<td>create</td>
<td>See detail in "<a href="/islandora_workbench_docs/fixity/">Fixity checking</a>".</td>
</tr>
<tr>
<td>term_name</td>
<td>create_terms</td>
<td>See detail in "<a href="/islandora_workbench_docs/creating_taxonomy_terms/">Creating taxonomy terms</a>".</td>
</tr>
</tbody>
</table>
<h3 id="values-in-the-file-column">Values in the "file" column</h3>
<p>Values in the <code>file</code> field contain the location of files that are used to create Drupal Media. Workbench can create only one media per CSV record; the type of media is determined by identifying in your configuration file a value from the "Islandora Media Use" vocabulary. File locations can be relative to the directory named in <code>input_dir</code>, absolute paths, or URLs. Examples of each:</p>
<ul>
<li>relative to directory named in the <code>input_dir</code> configuration setting: <code>myfile.png</code></li>
<li>absolute: <code>/tmp/data/myfile.png</code></li>
<li>URL: <code>http://example.com/files/myfile.png</code></li>
</ul>
<p>Things to note about <code>file</code> values in general:</p>
<ul>
<li>Relative, absolute, and URL file locations can exist within the same CSV file.</li>
<li>By default, if the <code>file</code> value for a row is empty, Workbench's <code>--check</code> option will show an error. But, in some cases you may want to create nodes but not add any media. If you add <code>allow_missing_files: true</code> to your config file for "create" tasks, you can leave the <code>file</code> column in your CSV empty.</li>
<li>By default, during <code>--check</code>, Workbench will exit when it first encounters a missing file (or an empty <code>file</code> value). If you would prefer that Workbench checked for the existence of all files before exiting, include <code>strict_check: false</code> in your configuration.</li>
<li>If you want do not want to create media for any of the rows in your CSV file, include <code>nodes_only: true</code> in your configuration file. More detail <a href="/islandora_workbench_docs/nodes_only/">is available</a>.</li>
<li><code>file</code> values that contain non-ASCII characters are normalized to their ASCII equivalents. See <a href="https://github.com/mjordan/islandora_workbench/issues/192">this issue</a> for more information.</li>
</ul>
<p>Things to note about URLs as <code>file</code> values:</p>
<ul>
<li>Workbench downloads files identified by URLs and saves them in the directory named in <code>input_dir</code> before processing them further; within this directory, each file is saved in a subdirectory named after the value in the row's <code>id_field</code> field. It does not delete the files from these locations after they have been ingested into Islandora unless the <code>delete_tmp_upload</code> configuration option is set to <code>true</code>.</li>
<li>Files identified by URLs must be accessible to the Workbench script, which means they must not require a username/password; however, they can be protected by a firewall, etc. as long as the computer running Workbench is allowed to retrieve the files without authenticating.</li>
<li>Currently Workbench requires that the URLs point directly to a file or a service that generates a file, and not a wrapper page or other indirect route to the file.</li>
</ul>
<h2 id="required-columns">Required columns</h2>
<p>A small number of columns are required in your CSV, depending on the task you are performing:</p>
<table>
<thead>
<tr>
<th>Task</th>
<th>Required in CSV</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>create</td>
<td>id</td>
<td>See detail in "Reserved CSV fields", above</td>
</tr>
<tr>
<td></td>
<td>title</td>
<td>The node title.</td>
</tr>
<tr>
<td></td>
<td>file</td>
<td>Empty values in the <code>file</code> field are allowed if <code>allow_missing_files</code> is present in your configuration file, in which case a node will be created but it will have no attached media.</td>
</tr>
<tr>
<td>update</td>
<td>node_id</td>
<td>The node ID of an existing node you are updating.</td>
</tr>
<tr>
<td>delete</td>
<td>node_id</td>
<td>The node ID of an existing node you are deleting.</td>
</tr>
<tr>
<td>add_media</td>
<td>node_id</td>
<td>The node ID of an existing node you are attaching media to.</td>
</tr>
<tr>
<td></td>
<td>file</td>
<td>Must contain a filename, file path, or URL. <code>allow_missing_files</code> only works with the <code>create</code> task.</td>
</tr>
</tbody>
</table>
<p>If a required field is missing from your CSV, <code>--check</code> will tell you.</p>
<h2 id="columns-you-want-workbench-to-ignore">Columns you want Workbench to ignore</h2>
<p>In some cases you might want to include columns in your CSV that you want Workbench to ignore. More information on this option is available in the "Sharing the input CSV with other applications" section of the <a href="/islandora_workbench_docs/workflows/#sharing-the-input-csv-with-other-applications">Workflows</a> documentation.</p>
<h2 id="csv-fields-that-contain-drupal-field-data">CSV fields that contain Drupal field data</h2>
<p>These are of two types of Drupal fields, base fields and content-type specific fields.</p>
<h3 id="base-fields">Base fields</h3>
<p>Base fields are basic node properties, shared by all content types. The base fields you can include in your CSV file are:</p>
<ul>
<li><code>title</code>: This field is required for all rows in your CSV for the <code>create</code> task. Optional for the 'update' task. Drupal limits the title's length to 255 characters,unless the <a href="https://www.drupal.org/project/title_length">Node Title Length</a> contrib module is installed. If that module is installed, you can set the maximum allowed title length using the <code>max_node_title_length</code> configuration setting.</li>
<li><code>langcode</code>: The language of the node. Optional. If included, use one of Drupal's language codes as values (common values are 'en', 'fr', and 'es'; the entire list can be seen <a href="https://git.drupalcode.org/project/drupal/-/blob/8.8.x/core/lib/Drupal/Core/Language/LanguageManager.php#L224">here</a>. If absent, Drupal sets the value to the default value for your content type.</li>
<li><code>uid</code>: The Drupal user ID to assign to the node and media created with the node. Optional. Only available in <code>create</code> tasks. If you are creating paged/compound objects from directories, this value is applied to the parent's children (if you are creating them using the page/child-level metadata method, these fields must be in your CSV metadata).</li>
<li><code>created</code>: The timestamp to use in the node's "created" attribute and in the "created" attribute of the media created with the node. Optional, but if present, it must be in format 2020-11-15T23:49:22+00:00 (the +00:00 is the difference to Greenwich time/GMT). If you are creating paged/compound objects from directories, this value is applied to the parent's children (if you are creating them using the page/child-level metadata method, these fields must be in your CSV metadata).</li>
</ul>
<p>All base fields can be included in <code>create</code> and <code>update</code> tasks.</p>
<h3 id="content-type-specific-fields">Content type-specific fields</h3>
<p>These fields correspond directly to fields configured in Drupal nodes, and data you provide in them populates their equivalent field in Drupal entities. The column headings in the CSV file must match machine names of fields that exist in the target node content type. Fields' machine names are visible within the "Manage fields" section of each content type's configuration, here circled in red:</p>
<p><img alt="Field machine names" src="../images/field_machine_names.png" /></p>
<p>These field names, plus the fields indicated in the "Reserved CSV fields" section above, are the column headers in your CSV file, like this:</p>
<pre><code class="text">file,id,title,field_model,field_description
IMG_1410.tif,01,Small boats in Havana Harbour,25,Taken on vacation in Cuba.
IMG_2549.jp2,02,Manhatten Island,25,&quot;Taken from the ferry from downtown New York to Highlands, NJ. Weather was windy.&quot;
IMG_2940.JPG,03,Looking across Burrard Inlet,25,View from Deep Cove to Burnaby Mountain. Simon Fraser University is visible on the top of the mountain in the distance.
IMG_2958.JPG,04,Amsterdam waterfront,25,Amsterdam waterfront on an overcast day.
IMG_5083.JPG,05,Alcatraz Island,25,&quot;Taken from Fisherman's Wharf, San Francisco.&quot;
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If content-type field values apply to all of the rows in your CSV file, you can avoid including them in the CSV and instead use "<a href="/islandora_workbench_docs/field_templates/">CSV field templates</a>".</p>
</div>
<h3 id="single-and-multi-valued-fields">Single and multi-valued fields</h3>
<p>Drupal allows for fields to have a single value, a specific maximum number of values, or unlimited number of values. In the CSV input file, each Drupal field corresponds to a single CSV field. In other words, the CSV column names must be unique, even if a Drupal field allows multiple values. Populating multivalued fields is explained below.</p>
<h4 id="single-valued-fields">Single-valued fields</h4>
<p>In your CSV file, single-valued fields simply contain the value, which, depending on the field type, can be a string or an integer. For example, using the fields defined by the Islandora Defaults module for the "Repository Item" content type, your CSV file could look like this:</p>
<pre><code class="text">file,title,id,field_model,field_description,field_rights,field_extent,field_access_terms,field_member_of
myfile.jpg,My nice image,obj_00001,24,&quot;A fine image, yes?&quot;,Do whatever you want with it.,There's only one image.,27,45
</code></pre>

<p>In this example, the term ID for the tag you want to assign in <code>field_access_terms</code> is 27, and the node ID of the collection you want to add the object to (in <code>field_member_of</code>) is 45.</p>
<h4 id="multivalued-fields">Multivalued fields</h4>
<p>For multivalued fields, you separate the values within a field with a pipe (<code>|</code>), like this:</p>
<pre><code class="text">file,title,field_something
IMG_1410.tif,Small boats in Havana Harbour,One subvalue|Another subvalue
IMG_2549.jp2,Manhatten Island,first subvalue|second subvalue|third subvalue
</code></pre>

<p>This works for string fields as well as taxonomy reference fields, e.g.:</p>
<pre><code class="text">file,title,field_my_multivalued_taxonomy_field
IMG_1410.tif,Small boats in Havana Harbour,35|46
IMG_2549.jp2,Manhatten Island,34|56|28
</code></pre>

<p>Drupal strictly enforces the maximum number of values allowed in a field. If the number of values in your CSV file for a field exceed a field's configured maximum number of fields, Workbench will only populate the field to the field's configured limit.</p>
<p>The subdelimiter character defaults to a pipe (<code>|</code>) but can be set in your config file using the <code>subdelimiter: ";"</code> option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Workbench will remove duplicate values in CSV fields. For example, if you accidently use <code>first subvalue|second subvalue|second subvalue</code> in your CSV, Workbench will filter out the superflous <code>second subvalue</code>. This applies to both <code>create</code> and <code>update</code> tasks, and within <code>update</code> tasks, replacing values and appending values to existing ones. Workbench deduplicates CVS values silently: it doesn't log the fact that it is doing it.</p>
</div>
<h3 id="drupal-field-types">Drupal field types</h3>
<p>The following types of Drupal fields can be populated from data in your input CSV file:</p>
<ul>
<li>text (plain, plain long, etc.) fields</li>
<li>integer fields</li>
<li>boolean fields, with values 1 or 0</li>
<li>EDTF date fields</li>
<li>entity reference (taxonomy and linked node) fields</li>
<li>typed relation (taxonomy) fields</li>
<li>link fields</li>
<li>geolocation fields</li>
</ul>
<p>Drupal is very strict about not accepting malformed data. Therefore, Islandora Workbench needs to provide data to Drupal that is consistent with field types (string, taxonomy reference, EDTF, etc.) we are populating. This applies not only to Drupal's base fields (as we saw above) but to all fields. A field's type is indicated in the same place as its machine name, within the "Manage fields" section of each content type's configuration. The field types are circled in red in the screen shot below:</p>
<p><img alt="Field machine names" src="../images/field_types.png" /></p>
<p>Below are guidelines for preparing CSV data that is compatible with common field types configured in Islandora repositories.</p>
<h4 id="text-fields">Text fields</h4>
<p>Generally speaking, any Drupal field where the user enters free text into a node add/edit form is configured to be one of the Drupal "Text" field types.</p>
<p>Islandora Workbench supports non-Latin characters in CSV, provided the CSV file is encoded as UTF-8. For example, the following non-Latin text will be added as expected to Drupal fields:</p>
<ul>
<li>一九二四年六月十二日 (Traditional Chinese)</li>
<li>सरकारी दस्तावेज़, अखबारों में छपे लेख, अकादमिक किताबें (Hindi)</li>
<li>ᐊᑕᐅᓯᖅ ᓄᓇ, ᐅᓄᖅᑐᑦ ᓂᐲᑦ (Inuktitut)</li>
</ul>
<p>However, if all of your characters are Latin (basically, the characters found on a standard US keyboard) your CSV file can be encoded as ASCII.</p>
<p>Some things to note about Drupal text fields:</p>
<ul>
<li>Islandora Workbench populates Drupal text fields verbatim with the content provided in the CSV file, but, depending on a field's configuration, Drupal may apply <a href="https://www.drupal.org/node/213156">text filters</a>.</li>
<li>Text fields may be configured to have a maximum length. Running Workbench with <code>--check</code> will produce a warning if any of the values in your CSV file surpass the configured maximum length of a field.</li>
<li>Some specialized forms of text fields, such as EDTF, enforce or prohibit the presence of specific types of characters (see below for EDTF's requirements).</li>
</ul>
<h4 id="taxonomy-reference-fields">Taxonomy reference fields</h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the list of a content type's fields, as pictured above, Drupal uses "Entity reference" for all types of entity reference fields, of which Taxonomy references are one. The other most common kind of entity reference field is a node reference field.</p>
</div>
<p>Islandora Workbench lets you assign both existing and new taxonomy terms to nodes. Creating new terms on demand during node creation reduces the need to prepopulate your vocabularies prior to creating nodes.</p>
<p>In CSV columns for taxonomy fields, you can use either term IDs (integers) or term names (strings). You can even mix IDs and names in the same field:</p>
<pre><code class="text">file,title,field_my_multivalued_taxonomy_field
img001.png,Picture of cats and yarn,Cats|46
img002.png,Picture of dogs and sticks,Dogs|Sticks
img003.png,Picture of yarn and needles,&quot;Yarn, Balls of|Knitting needles&quot;
</code></pre>

<p>By default, if you use a term name in your CSV data that doesn't match a term name that exists in the referenced taxonomy, Workbench will detect this when you use <code>--check</code>, warn you, and exit. This strict default is intended to prevent users from accidentally adding unwanted terms through data entry error.</p>
<p>Terms can be from any level in a vocabulary's hierarchy. In other words, if you have a vocabulary whose structure looks like this:</p>
<p><img alt="Hierarchical_vocabulary" src="../images/hierarchical_vocab.png" /></p>
<p>you can use the terms IDs or labels for "Automobiles", "Sports cars", or "Land Rover" in your CSV. The term name (or ID) is all you need; no indication of the term's place in the hierarchy is required.</p>
<p>If you add <code>allow_adding_terms: true</code> to your configuration file for <code>create</code> and <code>update</code> tasks, Workbench will create the new term the first time it is used in the CSV file following these rules:</p>
<ul>
<li>If multiple records in your CSV contain the same new term name in the same field, the term is only created once.</li>
<li>When Workbench checks to see if the term with the new name exists in the target vocabulary, it queries Drupal for the new term name, looking for an exact match against an existing term in the specified vocabulary. Therefore it is important that term names used in your CSV are identical to existing term names. The query to find existing term names follows these two rules:<ul>
<li>Leading and trailing whitespace on term names is ignored. Internal whitespace is significant.</li>
<li>Case is ignored.</li>
</ul>
</li>
<li>If the term name you provide in the CSV file does not match an existing term name in its vocabulary, the term name from the CSV data is used to create a new term. If it does match, Workbench populates the field in your nodes with a reference to the matching term.</li>
</ul>
<p>Adding new terms has some constraints:</p>
<ul>
<li>Terms created in this way do not have any external URIs. If you want your terms to have external URIs, you will need to either create the terms manually or add the URIs manually after the terms are created by Islandora Workbench.</li>
<li>Workbench cannot distinguish between identical term names within the same vocabulary. This means you cannot create two different terms that have the same term name (for example, two terms in the Person vocabulary that are identical but refer to two different people). The workaround for this is to create one of the terms before using Workbench and use the term ID instead of the term string.<ul>
<li>Related to this, if the same term name exists multiple times in the same vocabulary (again using the example of two Person terms that describe two different people) you should be aware that when you use these identical term names within the same vocabulary in your CSV, Workbench will always choose the first one it encounters when it converts from term names to term IDs while populating your nodes. The workaround for this is to use the term ID for one (or both) of the identical terms, or to use URIs for one (or both) of the identical terms.</li>
</ul>
</li>
<li><code>--check</code> will identify any new terms that exceed Drupal's maximum allowed length for term names, 255 characters. If a term name is longer than 255 characters, Workbench will truncate it at that length, log that it has done so, and create the term.</li>
<li>Taxonomy terms created with new nodes are not removed when you delete the nodes.</li>
<li>Currently, Islandora Workbench has the following limitations:<ul>
<li>It cannot create new taxonomy terms that have required fields other than the core term name field. <a href="https://github.com/mjordan/islandora_workbench/issues/111">This issue</a> addresses that limitation. As that issue documents, in order to support additional fields on taxonomy terms (both required and optional), Workbench will need a way to express complex term data in its input CSV. If you have an opinion on how this can be done, please leave a comment at that issue.</li>
<li>Workbench cannot currently create a new term that has another term as its parent (i.e. terms below the top level of a hierarchical taxonomy). However, for existing terms, Workbench doesn't care where they are in a taxonomy's hierarchy. <a href="https://github.com/mjordan/islandora_workbench/issues/236">Issue 236</a> will provide the ability to create terms at any level of a vocabulary's hierarchy. Creating taxonomy terms by including them in your CSV file adds new terms to the root of the applicable vocabulary.</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you would rather import vocabularies before referencing them using Workbench, check out the <a href="https://www.drupal.org/project/taxonomy_import">Taxonomy Import</a> contrib module.</p>
</div>
<h5 id="using-term-names-in-multi-vocabulary-fields">Using term names in multi-vocabulary fields</h5>
<p>While most node taxonomy fields reference only a single vocabulary, Drupal does allow fields to reference multiple vocabularies. This ability poses a problem when we use term names instead of term IDs in our CSV files: in a multi-vocabulary field, Workbench can't be sure which term name belongs in which of the multiple vocabularies referenced by that field. This applies to both existing terms and to new terms we want to add when creating node content.</p>
<p>To avoid this problem, we need to tell Workbench which of the multiple vocabularies each term name should (or does) belong to. We do this by namespacing terms with the applicable vocabulary ID.</p>
<p>For example, let's imagine we have a node field whose name is <code>field_sample_tags</code>, and this field references two vocabularies, "cats" and "dogs". To use the terms <code>Tuxedo</code>, <code>Tabby</code>, <code>German Shepherd</code> in the CSV when adding new nodes, we need to namespace them with vocabulary IDs like this:</p>
<pre><code class="text">field_sample_tags
cats:Tabby
cats:Tuxedo
dogs:German Shepherd
</code></pre>

<p>If you want to use multiple terms in a single field, you would namespace them all:</p>
<pre><code class="text">cats:Tuxedo|cats:Misbehaving|dogs:German Shepherd
</code></pre>

<p>To find the vocabulary ID (referred to above as the "namespace") to use, visit the list of your site's vocabularies at <code>admin/structure/taxonomy</code>:</p>
<p><img alt="Vocabulary names" src="../images/vocabulary_names.png" /></p>
<p>Hover your pointer over the "List terms" button for each vocabulary to reveal the URL to its overview page. The ID for the vocabulary is the string between "manage" and "overview" in the URL. For example, in the URL <code>admin/structure/taxonomy/manage/person/overview</code>, the vocabulary ID is "person". This is the namespace you need to use to indicate which vocabulary to add new terms to.</p>
<p>CSV values containing term names that have commas (<code>,</code>) in multi-valued, multi-vocabulary fields need to be wrapped in quotation marks (like any CSV value containing a comma), and in addition, the need to specify the namespace within each of the subvalues:</p>
<pre><code class="text">&quot;tags:gum, Bubble|tags:candy, Hard&quot;
</code></pre>

<p>Using these conventions, Workbench will be certain which vocabulary the term names belong to. Workbench will remind you during its <code>--check</code> operation that you need to namespace terms. It determines 1) if the field references multiple vocabularies, and then checks to see 2) if the field's values in the CSV are term IDs or term names. If you use term names in multi-vocabulary fields, and the term names aren't namespaced, Workbench will warn you:</p>
<pre><code>Error: Term names in multi-vocabulary CSV field &quot;field_tags&quot; require a vocabulary namespace; value &quot;Dogs&quot; in row 4 does not have one.
</code></pre>

<p>Note that since <code>:</code> is a special character when you use term names in multi-vocabulary CSV fields, you can't add a namespaced term that itself contains a <code>:</code>. You need to add it manually to Drupal and then use its term ID (or name, or URI) in your CSV file.</p>
<h5 id="using-term-uris-instead-of-term-ids">Using term URIs instead of term IDs</h5>
<p>Islandora Workbench lets you use URIs assigned to terms instead of term IDs. You can use a term URI in the <code>media_use_tid</code> configuration option (for example, <code>"http://pcdm.org/use#OriginalFile"</code>) and in taxonomy fields in your metadata CSV file:</p>
<pre><code>field_model
https://schema.org/DigitalDocument
http://purl.org/coar/resource_type/c_18cc
</code></pre>

<p>During <code>--check</code>, Workbench will validate that URIs correspond to existing taxonomy terms.</p>
<p>Using term URIs has some constraints:</p>
<ul>
<li>You cannot create a new term by providing a URI like you can by providing a term name.</li>
<li>If the same URI is registered with more than one term, Workbench will choose one and write a warning to the log indicating which term it chose and which terms the URI is registered with. However, <code>--check</code> will detect that a URI is registered with more than one term and warn you. At that point you can edit your CSV file to use the correct term ID rather than the URI.</li>
</ul>
<h4 id="entity-reference-views-fields">Entity Reference Views fields</h4>
<p>Under development. See <a href="https://github.com/mjordan/islandora_workbench/issues/452">this Github issue</a> for updates on supporting this field configuration.</p>
<h4 id="typed-relation-fields">Typed Relation fields</h4>
<p>Typed relation fields contain information about the relationship (or "relation") between a taxonomy term and the node it is attached to. For example, a term from the Person vocabulary, "Jordan, Mark", can be an author, illustrator, or editor of the book described in the node. In this example, "author", "illustrator", and "editor" are the typed relations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although Islandora supports Typed Relation fields that allow adding relations to other nodes, currently Workbench only supports adding relations to taxonomies. If you need support for adding Typed Relations to other entities, please leave a comment on <a href="https://github.com/mjordan/islandora_workbench/issues/421">this issue</a>.</p>
</div>
<p>The Controlled Access Terms module allows the relations to be sets of terms from external authority lists (for example like the <a href="https://www.loc.gov/marc/relators/relaterm.html">MARC Relators</a> list maintained by the Library of Congress). Within a Typed Relation field's configuration, the configured relations look like this:</p>
<p><img alt="Relations example" src="../images/relators.png" /></p>
<p>In this screenshot, "relators" is a namespace for the MARC Relators authority list, the codes "acp", "adi", etc are the codes for each relator, and "Art copyist", "Art director", etc. are the human-readable label for each relator.</p>
<p>Within the edit form of a node that has a Typed Relation field, the user interface adds a select list of the relation (the target taxonomy term here is "Jordan, Mark (30))", like this:</p>
<p><img alt="Linked agent example" src="../images/linked_agent.png" /></p>
<p>To be able to populate Typed Relation fields using CSV data with the three pieces of required data (authority list, relation type, target term), Islandora Workbench supports CSV values that contain the corresponding namespace, relator code, and taxonomy term ID, each separated by a colon (<code>:</code>), like this:</p>
<p><code>relators:art:30</code></p>
<p>In this example CSV value, <code>relators</code> is the namespace that the relation type <code>art</code> is from (the Library of Congress <a href="http://id.loc.gov/vocabulary/relators.html">Relators</a> vocabulary), and the target taxonomy term ID is <code>30</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the structure required for typed relation values in the CSV file is not the same as the structure of the relations configuration depicted in the screenshot of the "Available Relations" list above.</p>
</div>
<p>A second option for populating Typed Relation fields is to use taxonomy term names (as opposed to term IDs) as targets:</p>
<p><code>"relators:art:Jordan, Mark"</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In the next few paragraphs, the word "namespace" is used to describe two different kinds of namespaces - first, a vocabulary ID in the local Drupal and second, an ID for the external authority list of relators, for example by the Library of Congress.</p>
</div>
<p>As we saw in the "Using term names in multi-vocabulary fields" section above, if the field that we are populating references multiple vocabularies, we need to tell Drupal which vocabulary we are referring to with a local vocabulary namespace. To add a local vocabulary namespace to Typed Relation field CSV structure, we prepend it to the term name, like this (note the addition of "person"):</p>
<p><code>"relators:art:person:Jordan, Mark"</code></p>
<p>(In this example, <code>relators</code> is the external authority lists's namespace, and <code>person</code> is the local Drupal vocabulary namespace, prepended to the taxonomy term name, "Jordan, Mark".)</p>
<p>If this seems confusing and abstruse, don't worry. Running <code>--check</code> will tell you that you need to add the Drupal vocabulary namespace to values in specific CSV columns.</p>
<p>The final option for populating Typed Relation field is to use HTTP URIs as typed relation targets:</p>
<p><code>relators:art:http://markjordan.net</code></p>
<p>If you want to include multiple typed relation values in a single field of your CSV file (such as in "field_linked_agent"), separate the three-part values with the same subdelimiter character you use in other fields, e.g. (<code>|</code>) (or whatever you have configured as your <code>subdelimiter</code>):</p>
<p><code>relators:art:30|relators:art:45</code></p>
<p>or</p>
<p><code>"relators:art:person:Jordan, Mark|relators:art:45"</code></p>
<h5 id="adding-new-typed-relation-targets">Adding new typed relation targets</h5>
<p>Islandora Workbench allows you to add new typed relation targets while creating and updating nodes. These targets are taxonomy terms. Your configuration file must include the <code>allow_adding_terms: true</code> option to add new targets. In general, adding new typed relation targets is just like adding new taxonomy terms as described above in the "Taxonomy relation fields" section.</p>
<p>An example of a CSV value that adds a new target term is:</p>
<p><code>"relators:art:person:Jordan, Mark"</code></p>
<p>You can also add multiple new targets:</p>
<p><code>"relators:art:person:Annez, Melissa|relators:art:person:Jordan, Mark"</code></p>
<p>Note that:</p>
<ul>
<li>For multi-vocabulary fields, new typed relator targets must be accompanied by a vocabulary namespace (<code>person</code> in the above examples).</li>
<li>You cannot add new relators (e.g. <code>relators:foo</code>) in your CSV file, only new target terms.</li>
</ul>
<h4 id="edtf-fields">EDTF fields</h4>
<p>Running Islandora Workbench with <code>--check</code> will validate <a href="https://www.loc.gov/standards/datetime/">Extended Date/Time Format (EDTF) Specification</a> dates (Levels 0, 1, and 2) in EDTF fields. Some common examples include:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>Date</td>
<td>1976-04-23</td>
</tr>
<tr>
<td></td>
<td>1976-04</td>
</tr>
<tr>
<td>Qualified date</td>
<td>1976?</td>
</tr>
<tr>
<td></td>
<td>1976-04~</td>
</tr>
<tr>
<td></td>
<td>1976-04-24%</td>
</tr>
<tr>
<td>Date and time</td>
<td>1985-04-12T23:20:30</td>
</tr>
<tr>
<td>Interval</td>
<td>1964/2008</td>
</tr>
<tr>
<td></td>
<td>2004-06/2006-08</td>
</tr>
<tr>
<td></td>
<td>2004-06-04/2006-08-01</td>
</tr>
<tr>
<td></td>
<td>2004-06/2006-08-01</td>
</tr>
<tr>
<td>Set</td>
<td>[1667,1668,1670..1672]</td>
</tr>
<tr>
<td></td>
<td>[1672..1682]</td>
</tr>
<tr>
<td></td>
<td>[1672,1673]</td>
</tr>
<tr>
<td></td>
<td>[..1672]</td>
</tr>
<tr>
<td></td>
<td>[1672..]</td>
</tr>
</tbody>
</table>
<p>Subvalues in multivalued CSV fields are validated separately, e.g. if your CSV value is <code>2004-06/2006-08|2007-01/2007-04</code>, <code>2004-06/2006-08</code> and <code>2007-01/2007-04</code> are validated separately.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>EDTF supports a very wide range of specific and general dates, and in some cases, valid dates can look counterintuitive. For example, "2001-34" is valid (it's Sub-Year Grouping meaning 2nd quarter of 2001).</p>
</div>
<h4 id="link-fields">Link fields</h4>
<p>The link field type stores URLs (e.g. <code>https://acme.com</code>) and link text in separate data elements. To add or update fields of this type, Workbench needs to provide the URL and link text in the structure Drupal expects. To accomplish this within a single CSV field, we separate the URL and link text pairs in CSV values with double percent signs (<code>%%</code>), like this:</p>
<pre><code class="text">field_related_websites
http://acme.com%%Acme Products Inc.
</code></pre>

<p>You can include multiple pairs of URL/link text pairs in one CSV field if you separate them with the subdelimiter character:</p>
<pre><code class="text">field_related_websites
http://acme.com%%Acme Products Inc.|http://diy-first-aid.net%%DIY First Aid
</code></pre>

<p>The URL is required, but the link text is not. If you don't have or want any link text, omit it and the double quotation marks:</p>
<pre><code class="text">field_related_websites
http://acme.com
</code></pre>

<pre><code class="text">field_related_websites
http://acme.com|http://diy-first-aid.net%%DIY First Aid
</code></pre>

<h4 id="authority-link-fields">Authority link fields</h4>
<p>The aurhority link field type stores abbreviations for authority sources (i.e., external controlled vocabularies such as national name authorities), authority URIs (e.g. <code>http://viaf.org/viaf/153525475</code>) and link text in separate data elements. Authority link fields are most commonly used on taxonomy terms, but can be used on nodes as well.</p>
<p>To add or update fields of this type, Workbench needs to provide the authority source abbreviation, URI and link text in the structure Drupal expects. To accomplish this within a single CSV field, we separate the three parts in CSV values with double percent signs (<code>%%</code>), like this:</p>
<pre><code class="text">field_authority_vocabs
viaf%%http://viaf.org/viaf/10646807%%VIAF Record
</code></pre>

<p>You can include multiple triplets of source abbreviation/URL/link text in one CSV field if you separate them with the subdelimiter character:</p>
<pre><code class="text">field_authority_vocabs
viaf%%http://viaf.org/viaf/10646807%%VIAF Record|other%%https://github.com/mjordan%%Github
</code></pre>

<p>The authority source abbreviation and the URI are required, but the link text is not. If you don't have or want any link text, omit it:</p>
<pre><code class="text">field_authority_vocabs
viaf%%http://viaf.org/viaf/10646807
</code></pre>

<pre><code class="text">field_authority_vocabs
viaf%%http://viaf.org/viaf/10646807|other%%https://github.com/mjordan%%Github
</code></pre>

<h4 id="geolocation-fields">Geolocation fields</h4>
<p>The Geolocation field type, managed by the <a href="https://www.drupal.org/project/geolocation">Geolocation Field</a> contrib module, stores latitude and longitude coordinates in separate data elements. To add or update fields of this type, Workbench needs to provide the latitude and longitude data in these separate elements.</p>
<p>To simplify entering geocoordinates in the CSV file, Workbench allows geocoordinates to be in <code>lat,long</code> format, i.e., the latitude coordinate followed by a comma followed by the longitude coordinate. When Workbench reads your CSV file, it will split data on the comma into the required lat and long parts. An example of a single geocoordinate in a field would be:</p>
<pre><code class="text">field_coordinates
&quot;49.16667,-123.93333&quot;
</code></pre>

<p>You can include multiple pairs of geocoordinates in one CSV field if you separate them with the subdelimiter character:</p>
<pre><code class="text">field_coordinates
&quot;49.16667,-123.93333|49.25,-124.8&quot;
</code></pre>

<p>Note that:</p>
<ul>
<li>Geocoordinate values in your CSV need to be wrapped in double quotation marks, unless the <code>delimiter</code> key in your configuration file is set to something other than a comma.</li>
<li>If you are entering geocoordinates into a spreadsheet, a leading <code>+</code> will make the spreadsheet application think you are entering a formula. You can work around this by escaping the <code>+</code> with a backslash (<code>\</code>), e.g., <code>49.16667,-123.93333</code> should be <code>\+49.16667,-123.93333</code>, and <code>49.16667,-123.93333|49.25,-124.8</code> should be <code>\+49.16667,-123.93333|\+49.25,-124.8</code>. Workbench will strip the leading <code>\</code> before it populates the Drupal fields.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ignoring_csv_rows_and_columns/" class="btn btn-neutral float-right" title="Ignoring CSV rows and columns">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../preparing_data/" class="btn btn-neutral" title="Preparing your data"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/mjordan/islandora_workbench_docs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../preparing_data/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../ignoring_csv_rows_and_columns/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
